<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# script

```go
import "github.com/bitfield/script"
```

Package script aims to make it easy to write shell\-type scripts in Go\, for general system administration purposes: reading files\, counting lines\, matching strings\, and so on\.

## Index

- [type Pipe](<#type-pipe>)
  - [func Args() *Pipe](<#func-args>)
  - [func Echo(s string) *Pipe](<#func-echo>)
  - [func Exec(s string) *Pipe](<#func-exec>)
  - [func File(name string) *Pipe](<#func-file>)
  - [func FindFiles(path string) *Pipe](<#func-findfiles>)
  - [func IfExists(filename string) *Pipe](<#func-ifexists>)
  - [func ListFiles(path string) *Pipe](<#func-listfiles>)
  - [func NewPipe() *Pipe](<#func-newpipe>)
  - [func Slice(s []string) *Pipe](<#func-slice>)
  - [func Stdin() *Pipe](<#func-stdin>)
  - [func (p *Pipe) AppendFile(fileName string) (int64, error)](<#func-pipe-appendfile>)
  - [func (p *Pipe) Basename() *Pipe](<#func-pipe-basename>)
  - [func (p *Pipe) Bytes() ([]byte, error)](<#func-pipe-bytes>)
  - [func (p *Pipe) Close() error](<#func-pipe-close>)
  - [func (p *Pipe) Column(col int) *Pipe](<#func-pipe-column>)
  - [func (p *Pipe) Concat() *Pipe](<#func-pipe-concat>)
  - [func (p *Pipe) CountLines() (int, error)](<#func-pipe-countlines>)
  - [func (p *Pipe) Dirname() *Pipe](<#func-pipe-dirname>)
  - [func (p *Pipe) EachLine(process func(string, *strings.Builder)) *Pipe](<#func-pipe-eachline>)
  - [func (p *Pipe) Error() error](<#func-pipe-error>)
  - [func (p *Pipe) Exec(cmdLine string) *Pipe](<#func-pipe-exec>)
  - [func (p *Pipe) ExecForEach(cmdTpl string) *Pipe](<#func-pipe-execforeach>)
  - [func (p *Pipe) ExitStatus() int](<#func-pipe-exitstatus>)
  - [func (p *Pipe) First(lines int) *Pipe](<#func-pipe-first>)
  - [func (p *Pipe) Freq() *Pipe](<#func-pipe-freq>)
  - [func (p *Pipe) Join() *Pipe](<#func-pipe-join>)
  - [func (p *Pipe) Last(lines int) *Pipe](<#func-pipe-last>)
  - [func (p *Pipe) Match(s string) *Pipe](<#func-pipe-match>)
  - [func (p *Pipe) MatchRegexp(re *regexp.Regexp) *Pipe](<#func-pipe-matchregexp>)
  - [func (p *Pipe) Read(b []byte) (int, error)](<#func-pipe-read>)
  - [func (p *Pipe) Reject(s string) *Pipe](<#func-pipe-reject>)
  - [func (p *Pipe) RejectRegexp(re *regexp.Regexp) *Pipe](<#func-pipe-rejectregexp>)
  - [func (p *Pipe) Replace(search, replace string) *Pipe](<#func-pipe-replace>)
  - [func (p *Pipe) ReplaceRegexp(re *regexp.Regexp, replace string) *Pipe](<#func-pipe-replaceregexp>)
  - [func (p *Pipe) SHA256Sum() (string, error)](<#func-pipe-sha256sum>)
  - [func (p *Pipe) SHA256Sums() *Pipe](<#func-pipe-sha256sums>)
  - [func (p *Pipe) SetError(err error)](<#func-pipe-seterror>)
  - [func (p *Pipe) Slice() ([]string, error)](<#func-pipe-slice>)
  - [func (p *Pipe) Stdout() (int, error)](<#func-pipe-stdout>)
  - [func (p *Pipe) String() (string, error)](<#func-pipe-string>)
  - [func (p *Pipe) WithError(err error) *Pipe](<#func-pipe-witherror>)
  - [func (p *Pipe) WithReader(r io.Reader) *Pipe](<#func-pipe-withreader>)
  - [func (p *Pipe) WriteFile(fileName string) (int64, error)](<#func-pipe-writefile>)
- [type ReadAutoCloser](<#type-readautocloser>)
  - [func NewReadAutoCloser(r io.Reader) ReadAutoCloser](<#func-newreadautocloser>)
  - [func (a ReadAutoCloser) Close() error](<#func-readautocloser-close>)
  - [func (a ReadAutoCloser) Read(buf []byte) (n int, err error)](<#func-readautocloser-read>)


## type [Pipe](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L10-L13>)

Pipe represents a pipe object with an associated ReadAutoCloser\.

```go
type Pipe struct {
    Reader ReadAutoCloser
    // contains filtered or unexported fields
}
```

### func [Args](<https://github.com/mainawycliffe/script/blob/master/sources.go#L12>)

```go
func Args() *Pipe
```

Args creates a pipe containing the program's command\-line arguments\, one per line\.

### func [Echo](<https://github.com/mainawycliffe/script/blob/master/sources.go#L21>)

```go
func Echo(s string) *Pipe
```

Echo returns a pipe containing the supplied string\.

### func [Exec](<https://github.com/mainawycliffe/script/blob/master/sources.go#L28>)

```go
func Exec(s string) *Pipe
```

Exec runs an external command and returns a pipe containing the output\. If the command had a non\-zero exit status\, the pipe's error status will also be set to the string "exit status X"\, where X is the integer exit status\.

### func [File](<https://github.com/mainawycliffe/script/blob/master/sources.go#L47>)

```go
func File(name string) *Pipe
```

File returns a \*Pipe associated with the specified file\. This is useful for starting pipelines\. If there is an error opening the file\, the pipe's error status will be set\.

### func [FindFiles](<https://github.com/mainawycliffe/script/blob/master/sources.go#L60>)

```go
func FindFiles(path string) *Pipe
```

FindFiles takes a directory path and returns a pipe listing all the files in the directory and its subdirectories recursively\, one per line\, like Unix \`find \-type f\`\. If the path doesn't exist or can't be read\, the pipe's error status will be set\.

### func [IfExists](<https://github.com/mainawycliffe/script/blob/master/sources.go#L36>)

```go
func IfExists(filename string) *Pipe
```

IfExists tests whether the specified file exists\, and returns a pipe whose error status reflects the result\. If the file doesn't exist\, the pipe's error status will be set\, and if the file does exist\, the pipe will have no error status\.

### func [ListFiles](<https://github.com/mainawycliffe/script/blob/master/sources.go#L80>)

```go
func ListFiles(path string) *Pipe
```

ListFiles creates a pipe containing the files and directories matching the supplied path\, one per line\. The path may be a glob\, conforming to filepath\.Match syntax\.

### func [NewPipe](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L16>)

```go
func NewPipe() *Pipe
```

NewPipe returns a pointer to a new empty pipe\.

### func [Slice](<https://github.com/mainawycliffe/script/blob/master/sources.go#L108>)

```go
func Slice(s []string) *Pipe
```

Slice returns a pipe containing each element of the supplied slice of strings\, one per line\.

### func [Stdin](<https://github.com/mainawycliffe/script/blob/master/sources.go#L113>)

```go
func Stdin() *Pipe
```

Stdin returns a pipe which reads from the program's standard input\.

### func \(\*Pipe\) [AppendFile](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L17>)

```go
func (p *Pipe) AppendFile(fileName string) (int64, error)
```

AppendFile appends the contents of the Pipe to the specified file\, and closes the pipe after reading\. It returns the number of bytes successfully written\, or an error\. If there is an error reading or writing\, the pipe's error status is also set\.

### func \(\*Pipe\) [Basename](<https://github.com/mainawycliffe/script/blob/master/filters.go#L26>)

```go
func (p *Pipe) Basename() *Pipe
```

Basename reads a list of filepaths from the pipe\, one per line\, and removes any leading directory components from each line\. If a line is empty\, Basename will produce '\.'\. Trailing slashes are removed\.

### func \(\*Pipe\) [Bytes](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L23>)

```go
func (p *Pipe) Bytes() ([]byte, error)
```

Bytes returns the contents of the Pipe as a slice of byte\, or an error\. If there is an error reading\, the pipe's error status is also set\.

### func \(\*Pipe\) [Close](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L23>)

```go
func (p *Pipe) Close() error
```

Close closes the pipe's associated reader\. This is always safe to do\, because pipes created from a non\-closable source will have an \`ioutil\.NopCloser\` to call\.

### func \(\*Pipe\) [Column](<https://github.com/mainawycliffe/script/blob/master/filters.go#L41>)

```go
func (p *Pipe) Column(col int) *Pipe
```

Column reads from the pipe\, and returns a new pipe containing only the Nth column of each line in the input\, where '1' means the first column\, and columns are delimited by whitespace\. Specifically\, whatever Unicode defines as whitespace \('WSpace=yes'\)\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Concat](<https://github.com/mainawycliffe/script/blob/master/filters.go#L55>)

```go
func (p *Pipe) Concat() *Pipe
```

Concat reads a list of filenames from the pipe\, one per line\, and returns a pipe which reads all those files in sequence\. If there are any errors \(for example\, non\-existent files\)\, these will be ignored\, execution will continue\, and the pipe's error status will not be set\.

### func \(\*Pipe\) [CountLines](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L38>)

```go
func (p *Pipe) CountLines() (int, error)
```

CountLines counts lines from the pipe's reader\, and returns the integer result\, or an error\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Dirname](<https://github.com/mainawycliffe/script/blob/master/filters.go#L79>)

```go
func (p *Pipe) Dirname() *Pipe
```

Dirname reads a list of pathnames from the pipe\, one per line\, and returns a pipe which contains only the parent directories of each pathname\. If a line is empty\, Dirname will produce a '\.'\. Trailing slashes are removed\, unless Dirname returns the root folder\.

### func \(\*Pipe\) [EachLine](<https://github.com/mainawycliffe/script/blob/master/filters.go#L101>)

```go
func (p *Pipe) EachLine(process func(string, *strings.Builder)) *Pipe
```

EachLine calls the specified function for each line of input\, passing it the line as a string\, and a \*strings\.Builder to write its output to\. The return value from EachLine is a pipe containing the contents of the strings\.Builder\.

### func \(\*Pipe\) [Error](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L31>)

```go
func (p *Pipe) Error() error
```

Error returns the last error returned by any pipe operation\, or nil otherwise\.

### func \(\*Pipe\) [Exec](<https://github.com/mainawycliffe/script/blob/master/filters.go#L123>)

```go
func (p *Pipe) Exec(cmdLine string) *Pipe
```

Exec runs an external command and returns a pipe containing the output\. If the command had a non\-zero exit status\, the pipe's error status will also be set to the string "exit status X"\, where X is the integer exit status\.

### func \(\*Pipe\) [ExecForEach](<https://github.com/mainawycliffe/script/blob/master/filters.go#L147>)

```go
func (p *Pipe) ExecForEach(cmdTpl string) *Pipe
```

ExecForEach runs the supplied command once for each line of input\, and returns a pipe containing the output\. The command string is interpreted as a Go template\, so \`\{\{\.\}\}\` will be replaced with the input value\, for example\. If any command resulted in a non\-zero exit status\, the pipe's error status will also be set to the string "exit status X"\, where X is the integer exit status\.

### func \(\*Pipe\) [ExitStatus](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L43>)

```go
func (p *Pipe) ExitStatus() int
```

ExitStatus returns the integer exit status of a previous command\, if the pipe's error status is set\, and if the error matches the pattern "exit status %d"\. Otherwise\, it returns zero\.

### func \(\*Pipe\) [First](<https://github.com/mainawycliffe/script/blob/master/filters.go#L174>)

```go
func (p *Pipe) First(lines int) *Pipe
```

First reads from the pipe\, and returns a new pipe containing only the first N lines\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Freq](<https://github.com/mainawycliffe/script/blob/master/filters.go#L203>)

```go
func (p *Pipe) Freq() *Pipe
```

Freq reads from the pipe\, and returns a new pipe containing only unique lines from the input\, prefixed with a frequency count\, in descending numerical order \(most frequent lines first\)\. Lines with equal frequency will be sorted alphabetically\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Join](<https://github.com/mainawycliffe/script/blob/master/filters.go#L241>)

```go
func (p *Pipe) Join() *Pipe
```

Join reads the contents of the pipe\, line by line\, and joins them into a single space\-separated string\. It returns a pipe containing this string\. Any terminating newline is preserved\.

### func \(\*Pipe\) [Last](<https://github.com/mainawycliffe/script/blob/master/filters.go#L261>)

```go
func (p *Pipe) Last(lines int) *Pipe
```

Last reads from the pipe\, and returns a new pipe containing only the last N lines\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Match](<https://github.com/mainawycliffe/script/blob/master/filters.go#L293>)

```go
func (p *Pipe) Match(s string) *Pipe
```

Match reads from the pipe\, and returns a new pipe containing only lines which contain the specified string\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [MatchRegexp](<https://github.com/mainawycliffe/script/blob/master/filters.go#L305>)

```go
func (p *Pipe) MatchRegexp(re *regexp.Regexp) *Pipe
```

MatchRegexp reads from the pipe\, and returns a new pipe containing only lines which match the specified compiled regular expression\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Read](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L62>)

```go
func (p *Pipe) Read(b []byte) (int, error)
```

Read reads up to len\(b\) bytes from the data source into b\. It returns the number of bytes read and any error encountered\. At end of file\, or on a nil pipe\, Read returns 0\, io\.EOF\.

### func \(\*Pipe\) [Reject](<https://github.com/mainawycliffe/script/blob/master/filters.go#L317>)

```go
func (p *Pipe) Reject(s string) *Pipe
```

Reject reads from the pipe\, and returns a new pipe containing only lines which do not contain the specified string\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [RejectRegexp](<https://github.com/mainawycliffe/script/blob/master/filters.go#L329>)

```go
func (p *Pipe) RejectRegexp(re *regexp.Regexp) *Pipe
```

RejectRegexp reads from the pipe\, and returns a new pipe containing only lines which don't match the specified compiled regular expression\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Replace](<https://github.com/mainawycliffe/script/blob/master/filters.go#L341>)

```go
func (p *Pipe) Replace(search, replace string) *Pipe
```

Replace filters its input by replacing all occurrences of the string \`search\` with the string \`replace\`\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [ReplaceRegexp](<https://github.com/mainawycliffe/script/blob/master/filters.go#L353>)

```go
func (p *Pipe) ReplaceRegexp(re *regexp.Regexp, replace string) *Pipe
```

ReplaceRegexp filters its input by replacing all matches of the compiled regular expression \`re\` with the replacement string \`replace\`\. Inside \`replace\`\, $ signs are interpreted as in regexp\.Expand\, so for instance "$1" represents the text of the first submatch\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [SHA256Sum](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L52>)

```go
func (p *Pipe) SHA256Sum() (string, error)
```

SHA256Sum calculates the SHA\-256 of the file from the pipe's reader\, and returns the string result\, or an error\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [SHA256Sums](<https://github.com/mainawycliffe/script/blob/master/filters.go#L365>)

```go
func (p *Pipe) SHA256Sums() *Pipe
```

SHA256Sums reads a list of file paths from the pipe\, one per line\, and returns a pipe which contains the SHA\-256 checksum of each pathname\. If there are any errors \(for example\, non\-existent files\)\, the pipe's error status will be set to the first error encountered\, but execution will continue\.\`\`

### func \(\*Pipe\) [SetError](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L70>)

```go
func (p *Pipe) SetError(err error)
```

SetError sets the pipe's error status to the specified error\.

### func \(\*Pipe\) [Slice](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L69>)

```go
func (p *Pipe) Slice() ([]string, error)
```

Slice returns the contents of the pipe as a slice of strings\, one element per line\, or an error\. If there is an error reading the pipe\, the pipe's error status is also set\.

### func \(\*Pipe\) [Stdout](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L84>)

```go
func (p *Pipe) Stdout() (int, error)
```

Stdout writes the contents of the pipe to the program's standard output\. It returns the number of bytes successfully written\, plus a non\-nil error if the write failed or if there was an error reading from the pipe\. If the pipe has error status\, Stdout returns zero plus the existing error\.

### func \(\*Pipe\) [String](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L98>)

```go
func (p *Pipe) String() (string, error)
```

String returns the contents of the Pipe as a string\, or an error\, and closes the pipe after reading\. If there is an error reading\, the pipe's error status is also set\.

### func \(\*Pipe\) [WithError](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L89>)

```go
func (p *Pipe) WithError(err error) *Pipe
```

WithError sets the pipe's error status to the specified error and returns the modified pipe\.

### func \(\*Pipe\) [WithReader](<https://github.com/mainawycliffe/script/blob/master/pipes.go#L79>)

```go
func (p *Pipe) WithReader(r io.Reader) *Pipe
```

WithReader takes an io\.Reader\, and associates the pipe with that reader\. If necessary\, the reader will be automatically closed once it has been completely read\.

### func \(\*Pipe\) [WriteFile](<https://github.com/mainawycliffe/script/blob/master/sinks.go#L111>)

```go
func (p *Pipe) WriteFile(fileName string) (int64, error)
```

WriteFile writes the contents of the Pipe to the specified file\, and closes the pipe after reading\. It returns the number of bytes successfully written\, or an error\. If there is an error reading or writing\, the pipe's error status is also set\.

## type [ReadAutoCloser](<https://github.com/mainawycliffe/script/blob/master/read_auto_closer.go#L10-L12>)

ReadAutoCloser represents a pipe source which will be automatically closed once it has been fully read\.

```go
type ReadAutoCloser struct {
    // contains filtered or unexported fields
}
```

### func [NewReadAutoCloser](<https://github.com/mainawycliffe/script/blob/master/read_auto_closer.go#L40>)

```go
func NewReadAutoCloser(r io.Reader) ReadAutoCloser
```

NewReadAutoCloser returns an ReadAutoCloser wrapping the supplied Reader\. If the Reader is not a Closer\, it will be wrapped in a NopCloser to make it closable\.

### func \(ReadAutoCloser\) [Close](<https://github.com/mainawycliffe/script/blob/master/read_auto_closer.go#L30>)

```go
func (a ReadAutoCloser) Close() error
```

Close closes the data source associated with a\, and returns the result of that close operation\.

### func \(ReadAutoCloser\) [Read](<https://github.com/mainawycliffe/script/blob/master/read_auto_closer.go#L17>)

```go
func (a ReadAutoCloser) Read(buf []byte) (n int, err error)
```

Read reads up to len\(buf\) bytes from the data source into buf\. It returns the number of bytes read and any error encountered\. At end of file\, Read returns 0\, io\.EOF\. In the EOF case\, the data source will be closed\.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
